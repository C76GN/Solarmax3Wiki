@tailwind base;
@tailwind components;
@tailwind utilities;

/* 基本 Prose 样式增强 */
.prose {
    /* 可以根据需要调整基础字体大小和行高 */
    @apply text-gray-700 dark:text-gray-300 leading-relaxed;
}

.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
    @apply font-semibold text-gray-900 dark:text-gray-100 mt-8 mb-4 scroll-mt-20;
    /* scroll-mt 用于锚点定位 */
}

.prose h1 {
    @apply text-3xl border-b border-gray-300 dark:border-gray-700 pb-2 mb-6;
}

.prose h2 {
    @apply text-2xl border-b border-gray-300 dark:border-gray-700 pb-2 mb-5;
}

.prose h3 {
    @apply text-xl;
}

.prose h4 {
    @apply text-lg;
}

.prose p {
    @apply mb-5;
}

.prose ul,
.prose ol {
    @apply pl-6 mb-5;
}

.prose ul {
    @apply list-disc;
}

.prose ol {
    @apply list-decimal;
}

.prose li {
    @apply mb-2;
}

.prose li>p {
    @apply mb-1 inline;
}

/* 修正列表项内段落间距 */

.prose blockquote {
    @apply border-l-4 border-blue-300 dark:border-blue-600 pl-5 italic text-gray-600 dark:text-gray-400 my-6 py-2 bg-gray-100 dark:bg-gray-800 rounded-r;
}

.prose pre {
    @apply bg-gray-800 dark:bg-black/50 text-gray-100 dark:text-gray-200 p-4 rounded-lg overflow-x-auto my-6 text-sm shadow;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
}

.prose code:not(pre code) {
    @apply bg-red-100 text-red-800 px-1.5 py-0.5 rounded text-[0.9em] font-mono dark:bg-red-900/50 dark:text-red-300;
}

.prose pre code {
    @apply bg-transparent text-inherit p-0 text-sm;
}

/* 修正 hljs 默认样式可能带来的冲突 */
.prose pre code .hljs-comment {
    @apply text-gray-400 italic;
}

.prose pre code .hljs-keyword {
    @apply text-blue-400;
}

.prose pre code .hljs-string {
    @apply text-green-400;
}

.prose pre code .hljs-number {
    @apply text-yellow-400;
}

/* ...可以根据需要添加更多 highlight.js 的样式覆盖 */

.prose a {
    @apply text-cyan-600 dark:text-cyan-400 hover:text-cyan-800 dark:hover:text-cyan-300 underline decoration-cyan-600/50 hover:decoration-cyan-800 transition-colors duration-150;
}

.prose img {
    @apply max-w-full h-auto my-8 rounded-lg shadow-md mx-auto block border border-gray-200 dark:border-gray-700;
}

/* 强化表格样式 */
.prose table {
    @apply w-full my-8 border-collapse border border-gray-400 dark:border-gray-600 shadow;
    table-layout: auto;
    /* 或 'fixed' 根据需要 */
}

.prose th,
.prose td {
    @apply border border-gray-300 dark:border-gray-500 px-4 py-2 text-left text-sm;
    vertical-align: top;
    /* 确保单元格内容顶部对齐 */
}

.prose th {
    @apply bg-gray-100 dark:bg-gray-700 font-semibold text-gray-800 dark:text-gray-100;
}

.prose tbody tr:nth-child(even) {
    @apply bg-gray-50 dark:bg-gray-800/50;
}

.prose tbody tr:hover {
    @apply bg-gray-100 dark:bg-gray-700/50;
}

/* Tiptap 编辑器核心样式 (与 app.css 中的内容合并) */
.tiptap {
    /* 可根据需要添加编辑器容器的样式 */
}

.ProseMirror {
    @apply outline-none min-h-[150px];
    /* ProseMirror 编辑区域 */
}

.ProseMirror p.is-editor-empty:first-child::before {
    content: attr(data-placeholder);
    float: left;
    color: #adb5bd;
    pointer-events: none;
    height: 0;
}

.ProseMirror .selectedCell:after {
    z-index: 2;
    position: absolute;
    content: "";
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: rgba(37, 99, 235, 0.1);
    /* Tailwind blue-600 with opacity */
    pointer-events: none;
}

.ProseMirror .column-resize-handle {
    position: absolute;
    right: -2px;
    top: 0;
    bottom: -2px;
    /* 稍微扩展以方便点击 */
    width: 4px;
    background-color: #93c5fd;
    /* Tailwind blue-300 */
    pointer-events: all;
    /* 需要能响应事件 */
    cursor: col-resize;
    z-index: 20;
}

.ProseMirror.resize-cursor {
    cursor: col-resize;
}

/* 确保 Tiptap 生成的表格也有基础边框 (以防 prose 类未应用或被覆盖) */
.tiptap table th,
.tiptap table td {
    border: 1px solid #ccc;
}

.wiki-content-display table th,
/* 也为纯展示内容应用 */
.wiki-content-display table td {
    border: 1px solid #ccc;
}

/* 修正可能的暗黑模式下的代码块背景 */
.dark .prose pre {
    @apply bg-gray-900 text-gray-200;
}

/* 可选：为目录链接添加悬停/激活状态 */
#toc-container ul {
    list-style: none;
    padding-left: 0;
}

#toc-container li a {
    @apply block truncate transition-colors duration-150 text-sm;
    @apply text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400;
}

#toc-container li a.is-active {
    /* 需要JS配合添加is-active类 */
    @apply text-blue-600 dark:text-blue-400 font-semibold;
}